# Banana Slides 使用手册

> AI 原生 PPT 生成应用 - 从想法到演示文稿，一键生成

---

## 目录

1. [产品简介](#1-产品简介)
2. [安装部署](#2-安装部署)
3. [快速开始](#3-快速开始)
4. [系统设置](#4-系统设置)
5. [创建项目](#5-创建项目)
6. [大纲编辑](#6-大纲编辑)
7. [描述编辑](#7-描述编辑)
8. [图片生成](#8-图片生成)
9. [预览与导出](#9-预览与导出)
10. [素材库管理](#10-素材库管理)
11. [模板系统](#11-模板系统)
12. [历史版本](#12-历史版本)
13. [常见问题](#13-常见问题)

---

## 1. 产品简介

### 1.1 什么是 Banana Slides？

Banana Slides 是一款基于 AI 的原生 PPT 生成应用，支持从想法、大纲或详细描述自动生成完整的演示文稿。通过先进的 AI 技术，您可以：

- **一句话生成 PPT**：输入主题想法，AI 自动生成完整内容
- **智能解析大纲**：粘贴已有大纲，自动转换为结构化格式
- **AI 图片生成**：为每页自动生成精美的配图
- **自然语言编辑**：用自然语言描述修改需求，AI 自动执行

### 1.2 核心特性

| 特性 | 说明 |
|------|------|
| 多种创建方式 | 支持一句话、大纲、描述三种创建方式 |
| 参考文件支持 | 支持 PDF、DOCX、PPTX 等多种格式 |
| AI 图片生成 | 支持 Gemini、OpenAI 等多种模型 |
| 模板系统 | 预设模板 + 自定义模板 |
| 版本管理 | 自动保存历史版本，支持回退 |
| 多格式导出 | 支持 PPTX、PDF 格式导出 |

### 1.3 技术架构

- **前端**：React + TypeScript + Vite + Tailwind CSS
- **后端**：Flask + Python + SQLAlchemy
- **AI**：Google Gemini / OpenAI 兼容接口
- **部署**：Docker Compose

---

## 2. 安装部署

### 2.1 环境要求

- Docker 20.0+
- Docker Compose 2.0+
- 至少 4GB 可用内存
- AI API Key（Gemini 或 OpenAI）

### 2.2 Docker 部署（推荐）

```bash
# 1. 克隆项目
git clone https://github.com/arenaforme/Aippt.git
cd Aippt

# 2. 复制环境变量文件
cp .env.example .env

# 3. 编辑 .env 文件，配置 API Key
# GOOGLE_API_KEY=your-api-key
# AI_PROVIDER_FORMAT=gemini

# 4. 启动服务
docker compose up -d

# 5. 访问应用
# 前端：http://localhost:3000
# 后端：http://localhost:5002
```

### 2.3 本地开发部署

**后端：**
```bash
# 安装 uv（Python 包管理器）
curl -LsSf https://astral.sh/uv/install.sh | sh

# 安装依赖
uv sync

# 运行数据库迁移
cd backend && uv run alembic upgrade head

# 启动后端服务
uv run python app.py
```

**前端：**
```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

### 2.4 常用命令

```bash
# 查看日志
docker compose logs -f backend
docker compose logs -f frontend

# 重启服务
docker compose restart

# 停止服务
docker compose down

# 重新构建
docker compose up -d --build
```

---

## 3. 快速开始

### 3.1 完整使用流程

```
配置系统 → 创建项目 → 编辑大纲 → 生成描述 → 生成图片 → 预览导出
```

### 3.2 5 分钟快速体验

**第一步：配置 API**

1. 点击右上角「设置」图标
2. 选择 AI 提供商格式（推荐 Gemini）
3. 填入 API Key
4. 点击「保存设置」

**第二步：创建项目**

1. 在首页选择「一句话生成」
2. 输入主题，如："人工智能在医疗领域的应用"
3. 点击「生成大纲」

**第三步：生成内容**

1. 在大纲页面检查生成的大纲结构
2. 点击「生成描述」为每页生成详细描述
3. 点击「生成图片」为每页生成配图

**第四步：导出 PPT**

1. 在预览页面检查最终效果
2. 点击「导出 PPTX」下载文件

---

## 4. 系统设置

访问路径：点击右上角「设置」图标

### 4.1 大模型 API 配置

| 配置项 | 说明 | 示例值 |
|--------|------|--------|
| AI 提供商格式 | 选择 API 格式 | `gemini` 或 `openai` |
| API Base URL | API 基础地址 | `https://generativelanguage.googleapis.com` |
| API Key | API 密钥 | `AIzaSy...` |

**Gemini 配置示例：**
```
AI 提供商格式: gemini
API Base URL: https://generativelanguage.googleapis.com
API Key: AIzaSyxxxxxxxxxx
```

**OpenAI 配置示例：**
```
AI 提供商格式: openai
API Base URL: https://api.openai.com/v1
API Key: sk-xxxxxxxxxx
```

### 4.2 模型配置

| 模型类型 | 用途 | Gemini 推荐 | OpenAI 推荐 |
|----------|------|-------------|-------------|
| 文本大模型 | 生成大纲、描述 | gemini-3-flash-preview | gpt-4o |
| 图像生成模型 | 生成页面图片 | gemini-3-pro-image-preview | dall-e-3 |
| 图片识别模型 | 识别参考文件图片 | gemini-3-flash-preview | gpt-4o |

### 4.3 图像生成配置

| 配置项 | 选项 | 说明 |
|--------|------|------|
| 图像清晰度 | 1K / 2K / 4K | 分辨率越高，生成越慢 |
| 宽高比 | 16:9 | PPT 标准比例 |

> ⚠️ **注意**：OpenAI 模式仅支持 1K 分辨率

### 4.4 性能配置

| 配置项 | 范围 | 建议值 |
|--------|------|--------|
| 描述生成并发数 | 1-20 | 5-10 |
| 图像生成并发数 | 1-20 | 3-5 |

### 4.5 输出语言

| 选项 | 说明 |
|------|------|
| 中文 (zh) | 输出中文内容 |
| 英文 (en) | 输出英文内容 |
| 日文 (ja) | 输出日文内容 |
| 自动 (auto) | 根据输入自动检测 |

### 4.6 MinerU 配置（可选）

MinerU 用于解析参考文件（PDF、DOCX 等）：

| 配置项 | 说明 |
|--------|------|
| MinerU API Base | MinerU 服务地址 |
| MinerU Token | 访问令牌 |

---

## 5. 创建项目

### 5.1 三种创建方式

#### 方式一：一句话生成（推荐新手）

适用场景：只有一个主题想法，希望 AI 完全自动生成

1. 选择「一句话生成」标签
2. 输入主题描述，如：
   - "人工智能在医疗领域的应用"
   - "2024年公司年度总结汇报"
   - "新产品发布会演示"
3. 点击「生成大纲」

#### 方式二：从大纲生成

适用场景：已有大纲结构，希望 AI 补充详细内容

1. 选择「从大纲生成」标签
2. 粘贴大纲文本，格式示例：
```
# 人工智能医疗应用
## 第一部分：背景介绍
- 医疗行业现状
- AI 技术发展
## 第二部分：应用场景
- 影像诊断
- 药物研发
```
3. 点击「解析大纲」

#### 方式三：从描述生成

适用场景：已有详细的页面描述，希望直接生成图片

1. 选择「从描述生成」标签
2. 粘贴完整描述文本
3. 点击「解析描述」

### 5.2 上传参考文件

参考文件可以为 AI 提供背景知识，生成更准确的内容。

**支持格式：**
- 文档：PDF、DOCX、DOC、TXT、MD
- 表格：XLSX、XLS、CSV
- 演示：PPTX、PPT

**上传方式：**
1. 点击「上传参考文件」按钮
2. 选择文件（最大 200MB）
3. 等待文件解析完成
4. 解析后的内容会自动用于生成

**文件管理：**
- 支持从已上传文件中选择
- 支持预览文件内容
- 支持删除不需要的文件

### 5.3 添加素材图片

素材图片可以作为生成图片的参考。

**上传方式：**
- 点击上传按钮选择图片
- 拖拽图片到上传区域
- Ctrl+V 粘贴剪贴板图片

**支持格式：** PNG、JPG、JPEG、GIF、WEBP、BMP、SVG

### 5.4 选择模板

模板决定生成图片的视觉风格。

1. 点击「选择模板」
2. 从预设模板或用户模板中选择
3. 也可以上传自定义模板图片

---

## 6. 大纲编辑

### 6.1 大纲结构

大纲由以下层级组成：
- **部分（Part）**：将页面分组，如"第一部分：背景介绍"
- **页面（Page）**：每一页 PPT
- **要点（Points）**：每页的关键要点

### 6.2 编辑操作

| 操作 | 方法 |
|------|------|
| 添加页面 | 点击「+」按钮 |
| 删除页面 | 点击页面右侧删除图标 |
| 调整顺序 | 拖拽页面卡片 |
| 编辑标题 | 点击标题直接编辑 |
| 编辑要点 | 点击要点直接编辑 |

### 6.3 AI 辅助修改

使用自然语言描述修改需求：

**示例指令：**
- "增加一页关于市场分析的内容"
- "把第三页拆分成两页"
- "删除关于历史背景的部分"
- "调整顺序，把总结放到最后"

**操作步骤：**
1. 在修改输入框中输入指令
2. 点击「AI 修改」
3. 查看修改结果
4. 如不满意可继续修改

### 6.4 生成描述

完成大纲编辑后：

1. 点击「生成描述」按钮
2. 等待 AI 为每页生成详细描述
3. 进度条显示生成进度
4. 完成后自动跳转到描述编辑页面

---

## 7. 描述编辑

### 7.1 描述内容

每页描述包含：
- **页面标题**：该页的主题
- **详细描述**：页面的完整文字内容
- **布局建议**：AI 建议的页面布局方式
- **图片引用**：可引用素材库中的图片

### 7.2 编辑操作

| 操作 | 方法 |
|------|------|
| 编辑描述 | 点击描述文本直接编辑 |
| 单页重新生成 | 点击页面的「重新生成」按钮 |
| 插入图片 | 点击「插入素材」选择图片 |

### 7.3 AI 辅助修改

使用自然语言批量修改所有描述：

**示例指令：**
- "让描述更加详细具体"
- "增加更多数据和案例"
- "使用更专业的术语"
- "缩短每页的描述长度"

### 7.4 引用素材图片

在描述中引用素材图片：

1. 点击「插入素材」按钮
2. 从素材库选择图片
3. 图片链接自动插入描述
4. 生成图片时会参考这些素材

---

## 8. 图片生成

### 8.1 批量生成

为所有页面生成图片：

1. 点击「生成全部图片」按钮
2. 查看生成进度
3. 等待所有页面完成
4. 失败的页面可以单独重新生成

### 8.2 单页生成

为单个页面生成或重新生成图片：

1. 点击页面缩略图
2. 点击「重新生成」按钮
3. 等待生成完成

### 8.3 图片编辑

使用自然语言编辑已生成的图片：

**示例指令：**
- "把背景颜色改成蓝色"
- "添加一个饼图"
- "把标题字体放大"
- "增加一些装饰元素"

**操作步骤：**
1. 选择要编辑的页面
2. 点击「编辑图片」按钮
3. 输入编辑指令
4. 可选择添加参考图片
5. 点击「应用修改」

### 8.4 版本管理

每次生成或编辑都会保存版本：

1. 点击「历史版本」按钮
2. 查看所有历史版本
3. 点击版本可预览
4. 点击「使用此版本」切换

### 8.5 更换模板

在预览页面更换模板：

1. 点击「更换模板」按钮
2. 选择新模板
3. 重新生成图片以应用新模板

---

## 9. 预览与导出

### 9.1 预览功能

| 功能 | 说明 |
|------|------|
| 缩略图浏览 | 左侧显示所有页面缩略图 |
| 单页预览 | 点击缩略图查看大图 |
| 全屏预览 | 点击全屏按钮进入全屏模式 |
| 页面导航 | 使用上/下一页按钮切换 |

### 9.2 导出 PPTX

1. 点击「导出 PPTX」按钮
2. 输入文件名（可选）
3. 等待导出完成
4. 自动下载文件

**导出规格：**
- 格式：PowerPoint 2016+ 兼容
- 比例：16:9
- 每页一张图片

### 9.3 导出 PDF

1. 点击「导出 PDF」按钮
2. 输入文件名（可选）
3. 等待导出完成
4. 自动下载文件

---

## 10. 素材库管理

### 10.1 访问素材库

- 在创建项目时点击「素材库」
- 在描述编辑时点击「插入素材」

### 10.2 上传素材

**方式一：直接上传**
1. 点击「上传素材」按钮
2. 选择图片文件

**方式二：拖拽上传**
- 将图片拖拽到上传区域

**方式三：粘贴上传**
- 复制图片后按 Ctrl+V

### 10.3 AI 生成素材

1. 点击「AI 生成」按钮
2. 输入图片描述
3. 可选择添加参考图片
4. 点击「生成」

### 10.4 素材管理

| 操作 | 方法 |
|------|------|
| 预览素材 | 点击素材缩略图 |
| 删除素材 | 点击删除图标 |
| 筛选素材 | 按项目筛选 |
| 关联项目 | 将素材关联到当前项目 |

---

## 11. 模板系统

### 11.1 预设模板

系统内置多种风格模板：
- 复古卷轴
- 矢量插画
- 拟物玻璃
- 科技蓝
- 简约商务
- 学术报告

### 11.2 上传自定义模板

1. 点击「上传模板」按钮
2. 选择模板图片
3. 输入模板名称（可选）
4. 模板保存到用户模板库

### 11.3 模板制作建议

| 要素 | 建议 |
|------|------|
| 尺寸 | 16:9 比例（如 1920x1080） |
| 内容 | 包含目标视觉风格元素 |
| 清晰度 | 高清图片效果更好 |
| 风格 | 可以是 PPT 截图、设计稿等 |

### 11.4 管理模板

| 操作 | 方法 |
|------|------|
| 查看模板 | 在模板选择器中浏览 |
| 删除模板 | 点击模板右上角删除图标 |
| 应用模板 | 点击模板选中使用 |

---

## 12. 历史版本

### 12.1 项目历史

访问路径：点击顶部「历史」按钮

**项目列表显示：**
- 项目名称/主题
- 创建时间
- 更新时间
- 页面数量
- 项目状态

**项目操作：**
| 操作 | 说明 |
|------|------|
| 继续编辑 | 打开项目继续编辑 |
| 删除项目 | 删除项目及所有相关文件 |

### 12.2 页面版本

每个页面的图片版本管理：

1. 在预览页面选择页面
2. 点击「历史版本」按钮
3. 查看所有版本列表
4. 点击版本预览
5. 点击「使用此版本」切换

---

## 13. 常见问题

### 13.1 API 配置问题

**Q: 提示 API Key 无效？**
- 检查 API Key 是否正确复制
- 确认 API Key 未过期
- 检查 API Base URL 是否正确

**Q: 生成速度很慢？**
- 检查网络连接
- 尝试降低图像分辨率
- 减少并发数

**Q: OpenAI 模式图片质量不好？**
- OpenAI 模式仅支持 1K 分辨率
- 推荐使用 Gemini 模式获得更好效果

### 13.2 图片生成问题

**Q: 图片生成失败？**
- 检查 API 配置是否正确
- 确认已选择模板
- 查看后端日志获取详细错误

**Q: 生成的图片风格不一致？**
- 确保所有页面使用相同模板
- 在描述中保持一致的风格要求

**Q: 如何让图片包含特定元素？**
- 在描述中明确说明需要的元素
- 上传参考图片作为素材
- 使用图片编辑功能调整

### 13.3 文件问题

**Q: 参考文件解析失败？**
- 检查文件格式是否支持
- 确认文件大小不超过 200MB
- 检查 MinerU 服务是否配置

**Q: 导出的 PPTX 打不开？**
- 确保使用 PowerPoint 2016 或更高版本
- 尝试使用 WPS 或 LibreOffice 打开

### 13.4 性能问题

**Q: 页面加载很慢？**
- 清除浏览器缓存
- 检查网络连接
- 减少同时打开的项目数

**Q: Docker 容器启动失败？**
- 检查端口是否被占用
- 确认 Docker 内存分配足够
- 查看容器日志排查问题

---

## 附录

### A. 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+V | 粘贴上传图片 |
| Ctrl+S | 保存当前编辑 |
| ← / → | 切换上/下一页 |
| Esc | 退出全屏预览 |

### B. 支持的文件格式

| 类型 | 格式 |
|------|------|
| 文档 | PDF, DOCX, DOC, TXT, MD |
| 表格 | XLSX, XLS, CSV |
| 演示 | PPTX, PPT |
| 图片 | PNG, JPG, JPEG, GIF, WEBP, BMP, SVG |

### C. API 限制

| 提供商 | 图像分辨率 | 参考图片 | 图片编辑 |
|--------|------------|----------|----------|
| Gemini | 1K/2K/4K | ✅ 支持 | ✅ 支持 |
| OpenAI | 仅 1K | ❌ 不支持 | ❌ 不支持 |

### D. 联系支持

- GitHub Issues: https://github.com/arenaforme/Aippt/issues
- 项目主页: https://github.com/arenaforme/Aippt

---

*文档版本: 1.0.0*
*最后更新: 2025年12月*
